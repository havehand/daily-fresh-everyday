(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6d5f0ec4"],{"02aa":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"product-detail"},[a("a-steps",{staticClass:"steps",attrs:{current:e.current}},e._l(e.steps,(function(e){return a("a-step",{key:e.title,attrs:{title:e.title}})})),1),a("div",{staticClass:"steps-content"},[a("BasicDetail",{directives:[{name:"show",rawName:"v-show",value:0===e.current,expression:"current === 0"}],attrs:{current:e.current,steps:e.steps,form:e.form.base},on:{next:function(t){e.current+=1}}}),a("SaleDetail",{directives:[{name:"show",rawName:"v-show",value:1===e.current,expression:"current === 1"}],attrs:{form:e.form.sale},on:{finish:e.handleFinish,prev:function(t){e.current-=1},pushImg:e.handlePushImg,deleteImg:e.handleDeleteImg}})],1)],1)},s=[],i=a("5530"),o=(a("4de4"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"basic-detail"},[a("a-form-model",{ref:"ruleForm",attrs:{model:e.form,"label-col":e.labelCol,"wrapper-col":e.wrapperCol}},[a("a-form-model-item",{ref:"name",attrs:{label:"商品标题",required:"",prop:"title"}},[a("a-input",{model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),a("a-form-model-item",{attrs:{label:"商品描述",prop:"desc"}},[a("a-input",{model:{value:e.form.desc,callback:function(t){e.$set(e.form,"desc",t)},expression:"form.desc"}})],1),a("a-form-model-item",{attrs:{label:"商品类目",required:!0,prop:"category"}},[a("a-select",{attrs:{placeholder:"请选择商品类别"},on:{change:e.changeCategory},model:{value:e.form.category,callback:function(t){e.$set(e.form,"category",t)},expression:"form.category"}},e._l(e.categoryList,(function(t){return a("a-select-option",{key:t.id,attrs:{value:t.id}},[e._v(" "+e._s(t.name)+" ")])})),1),a("a-select",{attrs:{placeholder:"请选择子类目"},model:{value:e.form.c_items,callback:function(t){e.$set(e.form,"c_items",t)},expression:"form.c_items"}},e._l(e.categoryItems,(function(t){return a("a-select-option",{key:t,attrs:{value:t}},[e._v(" "+e._s(t)+" ")])})),1)],1),a("a-form-model-item",{attrs:{label:"商品标签",prop:"tags",required:""}},[a("a-select",{attrs:{mode:"tags",placeholder:"Please select","default-value":["包邮，最晚次日达"]},model:{value:e.form.tags,callback:function(t){e.$set(e.form,"tags",t)},expression:"form.tags"}},[a("a-select-option",{attrs:{value:"包邮，最晚次日达"}},[e._v(" "+e._s("包邮最晚次日达")+" ")])],1)],1),a("a-form-model-item",[a("div",{staticClass:"steps-action"},[a("a-button",{attrs:{type:"primary"},on:{click:e.next}},[e._v(" 下一步 ")])],1)])],1)],1)}),n=[],l=a("b85c"),c=a("c405"),u={name:"basicDetail",props:["current","form"],data:function(){return{categoryList:[],categoryItems:[],labelCol:{span:5},wrapperCol:{span:13},rules:[]}},methods:{changeCategory:function(e){console.log(e);var t,a=Object(l["a"])(this.categoryList);try{for(a.s();!(t=a.n()).done;){var r=t.value;if(r.id===e)return void(this.categoryItems=r.c_items)}}catch(s){a.e(s)}finally{a.f()}},next:function(){var e=this;this.$refs.ruleForm.validate((function(t){if(!t)return e.$emit("next"),!1;e.$emit("next")}))}},mounted:function(){var e=this;c["a"].list(this.$store.state.user).then((function(t){e.categoryList=t.data}))}},m=u,f=(a("e227"),a("2877")),p=Object(f["a"])(m,o,n,!1,null,"3094c6e7",null),d=p.exports,h=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"sale-detail"},[a("a-form-model",{ref:"ruleForm",attrs:{model:e.form,"label-col":e.labelCol,"wrapper-col":e.wrapperCol}},[a("a-form-model-item",{ref:"name",attrs:{label:"商品价格",required:"",prop:"price"}},[a("a-input",{model:{value:e.form.price,callback:function(t){e.$set(e.form,"price",t)},expression:"form.price"}})],1),a("a-form-model-item",{attrs:{label:"折扣价格",prop:"price_off"}},[a("a-input",{model:{value:e.form.price_off,callback:function(t){e.$set(e.form,"price_off",t)},expression:"form.price_off"}})],1),a("a-form-model-item",{attrs:{label:"商品库存",required:!0,prop:"inventory"}},[a("a-input",{model:{value:e.form.inventory,callback:function(t){e.$set(e.form,"inventory",t)},expression:"form.inventory"}})],1),a("a-form-model-item",{attrs:{label:"计量单位",prop:"unit",required:""}},[a("a-input",{model:{value:e.form.unit,callback:function(t){e.$set(e.form,"unit",t)},expression:"form.unit"}})],1),a("a-form-model-item",{attrs:{label:"商品相册",prop:"images"}},[a("a-upload",{attrs:{action:"https://mallapi.duyiedu.com/upload/images?appkey="+this.$store.state.user.appkey,"list-type":"picture-card","file-list":e.fileList,name:"avatar"},on:{preview:e.handlePreview,change:e.handleChange}},[e.fileList.length<8?a("div",[a("a-icon",{attrs:{type:"plus"}}),a("div",{staticClass:"ant-upload-text"},[e._v(" Upload ")])],1):e._e()]),a("a-modal",{attrs:{visible:e.previewVisible,footer:null},on:{cancel:e.handleCancel}},[a("img",{staticStyle:{width:"100%"},attrs:{alt:"example",src:e.previewImage}})])],1),a("a-form-model-item",[a("div",{staticClass:"steps-action"},[a("a-button",{attrs:{type:"primary"},on:{click:e.prev}},[e._v(" 上一步 ")]),a("a-button",{staticStyle:{"margin-left":"30px"},attrs:{type:"primary"},on:{click:e.finish}},[e._v(" 提交 ")])],1)])],1)],1)},v=[],g=a("1da1");a("96cf"),a("d3b7");function b(e){return new Promise((function(t,a){var r=new FileReader;r.readAsDataURL(e),r.onload=function(){return t(r.result)},r.onerror=function(e){return a(e)}}))}var y={name:"saleDetail",props:["form"],data:function(){return{fileList:[],labelCol:{span:5},wrapperCol:{span:13},previewVisible:!1,previewImage:""}},methods:{handleCancel:function(){this.previewVisible=!1},handlePreview:function(e){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(e.url||e.preview){a.next=4;break}return a.next=3,b(e.originFileObj);case 3:e.preview=a.sent;case 4:t.previewImage=e.url||e.preview,t.previewVisible=!0;case 6:case"end":return a.stop()}}),a)})))()},handleChange:function(e){var t=e.fileList,a=e.file;"done"===a.status&&this.$emit("pushImg",a.response.data.url),"removed"===a.status&&this.$emit("deleteImg",a.response.data.url),this.fileList=t},prev:function(){this.$emit("prev")},finish:function(){this.$emit("finish")}},mounted:function(){var e=this,t=1;setTimeout((function(){if(e.form.images){var a,r=Object(l["a"])(e.form.images);try{for(r.s();!(a=r.n()).done;){var s=a.value;e.fileList.push({uid:"-"+t,name:"image.png",status:"done",url:s}),t+=1}}catch(i){r.e(i)}finally{r.f()}}}),1e3)}},w=y,$=(a("7ef1"),Object(f["a"])(w,h,v,!1,null,"c612609a",null)),_=$.exports,x=a("c4c8"),k={name:"productAdd",components:{BasicDetail:d,SaleDetail:_},data:function(){return{current:0,steps:[{title:"填写商品基本信息",content:"First-content"},{title:"填写商品销售信息",content:"Second-content"}],form:{base:{title:"",desc:"",category:"",c_items:[],tags:[]},sale:{price:0,price_off:0,inventory:0,unit:"",images:[],status:1,sale:10010}}}},methods:{handleFinish:function(){var e=this;-1!==this.$route.path.indexOf("edit")?x["a"].edit(Object(i["a"])(Object(i["a"])({appkey:this.$store.state.user.appkey,id:this.$route.params.id},this.form.base),this.form.sale)).then((function(){e.$message.success("修改成功"),e.$router.push({name:"ProductList"}),e.$store.commit("changeMenuCurrent","ProductList")})):x["a"].add(Object(i["a"])(Object(i["a"])({appkey:this.$store.state.user.appkey},this.form.base),this.form.sale)).then((function(){e.$message.success("添加成功"),e.$router.push({name:"ProductList"}),e.$store.commit("changeMenuCurrent","ProductList")}))},handlePushImg:function(e){this.form.sale.images.push(e)},handleDeleteImg:function(e){this.form.sale.images=this.form.sale.images.filter((function(t){return t!==e}))}},mounted:function(){var e=this;if(-1!==this.$route.path.indexOf("edit")){var t=this.$route.params.id;x["a"].detail(t,this.$store.state.user).then((function(t){e.form.base.title=t.title,e.form.base.desc=t.desc,e.form.base.category=t.category,e.form.base.c_items=t.c_items,e.form.base.tags=t.tags,e.form.sale.price=t.price,e.form.sale.price_off=t.price_off,e.form.sale.inventory=t.inventory,e.form.sale.unit=t.unit,e.form.sale.images=t.images,e.form.sale.status=t.status}))}}},C=k,L=(a("9791"),Object(f["a"])(C,r,s,!1,null,"8e7d64f4",null));t["default"]=L.exports},"7ef1":function(e,t,a){"use strict";a("f13a")},9791:function(e,t,a){"use strict";a("b752")},b752:function(e,t,a){},b9c3:function(e,t,a){},e227:function(e,t,a){"use strict";a("b9c3")},f13a:function(e,t,a){}}]);
//# sourceMappingURL=chunk-6d5f0ec4.6440e8f2.js.map